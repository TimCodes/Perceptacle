# Monorepo Architecture Proof of Concept

A modern monorepo web application demonstrating scalable architecture patterns with independent packages, shared utilities, and comprehensive Docker orchestration.

## ğŸ—ï¸ Architecture Overview

This project showcases a production-ready monorepo structure with three core packages:

- **@poc/client** - React frontend with Vite build system
- **@poc/server** - Express.js API backend with TypeScript
- **@poc/core** - Shared utilities, types, and common functionality

## ğŸ“¦ Package Structure

```
monorepo-poc/
â”œâ”€â”€ packages/
â”‚   â”œâ”€â”€ client/          # React frontend application
â”‚   â”‚   â”œâ”€â”€ src/
â”‚   â”‚   â”œâ”€â”€ Dockerfile
â”‚   â”‚   â”œâ”€â”€ nginx.conf
â”‚   â”‚   â””â”€â”€ package.json
â”‚   â”œâ”€â”€ server/          # Express.js backend API
â”‚   â”‚   â”œâ”€â”€ src/
â”‚   â”‚   â”œâ”€â”€ Dockerfile
â”‚   â”‚   â””â”€â”€ package.json
â”‚   â””â”€â”€ core/            # Shared utilities library
â”‚       â”œâ”€â”€ src/
â”‚       â”œâ”€â”€ Dockerfile
â”‚       â””â”€â”€ package.json
â”œâ”€â”€ nginx/               # Reverse proxy configuration
â”œâ”€â”€ docker-compose.yml   # Production orchestration
â”œâ”€â”€ docker-compose.dev.yml # Development orchestration
â””â”€â”€ package.json         # Workspace configuration
```

## ğŸš€ Quick Start

### Prerequisites

- Node.js 20+
- Docker & Docker Compose
- npm 9+

### Development Setup

1. **Clone and install dependencies:**
   ```bash
   git clone <repository-url>
   cd monorepo-poc
   npm install
   ```

2. **Start development servers:**
   ```bash
   npm run dev
   ```

3. **Access the application:**
   - Frontend: http://localhost:3000
   - Backend API: http://localhost:3001

### Docker Development

1. **Start all services in development mode:**
   ```bash
   docker-compose -f docker-compose.dev.yml up
   ```

2. **Build and start production containers:**
   ```bash
   docker-compose up --build
   ```

3. **Access via reverse proxy:**
   - Application: http://localhost
   - API: http://localhost/api

## ğŸ³ Docker Orchestration

### Service Architecture

```mermaid
graph TB
    A[Nginx Reverse Proxy :80] --> B[Client Container :80]
    A --> C[Server Container :3001]
    B --> D[Core Package Volume]
    C --> D
    C --> E[Database]
```

### Container Services

| Service | Port | Purpose | Health Check |
|---------|------|---------|--------------|
| nginx | 80, 443 | Reverse proxy & load balancer | `/health` |
| client | 3000 â†’ 80 | React frontend application | HTTP response |
| server | 3001 | Express.js API backend | `/api/health` |
| core | N/A | Shared utilities library | Build status |

### Docker Commands

```bash
# Development workflow
docker-compose -f docker-compose.dev.yml up -d

# Production deployment
docker-compose up -d

# Scale specific services
docker-compose up --scale server=3

# View logs
docker-compose logs -f server

# Rebuild and restart
docker-compose up --build --force-recreate

# Clean up
docker-compose down -v --remove-orphans
```

## ğŸ› ï¸ Development Workflow

### NPM Workspace Commands

```bash
# Install dependencies for all packages
npm install

# Run development servers for all packages
npm run dev

# Build all packages for production
npm run build

# Test all packages
npm run test

# Work with specific packages
npm run dev --workspace=@poc/client
npm run build --workspace=@poc/server
npm run test --workspace=@poc/core
```

### Package-Specific Development

```bash
# Client development
cd packages/client
npm run dev

# Server development
cd packages/server
npm run dev

# Core library development
cd packages/core
npm run dev
```

## ğŸ“ Package Details

### @poc/client

**Technologies:** React 18, Vite, TypeScript, Tailwind CSS

**Features:**
- Modern React hooks and components
- GitHub-inspired UI design
- Interactive monorepo visualization
- Hot module replacement in development
- Optimized production builds with Nginx

**Docker Features:**
- Multi-stage build for optimized production image
- Nginx reverse proxy with compression
- Static asset caching and security headers

### @poc/server

**Technologies:** Express.js, TypeScript, CORS

**Features:**
- RESTful API endpoints
- Shared utility integration
- Environment-based configuration
- Health check endpoints
- Production-ready error handling

**Docker Features:**
- Non-root user security
- Health checks for container orchestration
- Environment variable configuration
- Optimized for horizontal scaling

### @poc/core

**Technologies:** TypeScript, ES6 Modules

**Features:**
- Shared type definitions
- Common utility functions
- API response formatting
- Request validation helpers
- Cross-package compatibility

**Docker Features:**
- Lightweight build container
- Shared volume for package distribution
- Build artifact optimization

## ğŸ”§ Configuration

### Environment Variables

Copy `.env.example` to `.env` and configure:

```bash
# Server Configuration
NODE_ENV=development
PORT=3001

# Client Configuration
VITE_API_URL=http://localhost:3001

# Docker Configuration
COMPOSE_PROJECT_NAME=monorepo-poc
```

### Nginx Configuration

The reverse proxy provides:
- Rate limiting (10 req/s for API, 50 req/s for static)
- Security headers (XSS protection, content type validation)
- GZIP compression
- Static asset caching
- Health check endpoints

## ğŸš¢ Deployment

### Production Deployment

```bash
# Build and start all services
docker-compose up -d

# Check service health
docker-compose ps
docker-compose logs

# Scale backend services
docker-compose up --scale server=3 -d
```

### CI/CD Integration

```yaml
# Example GitHub Actions workflow
name: Build and Deploy
on: [push]
jobs:
  build:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v3
      - name: Build images
        run: docker-compose build
      - name: Run tests
        run: docker-compose run --rm server npm test
      - name: Deploy
        run: docker-compose up -d
```

## ğŸ” Monitoring & Health Checks

### Health Endpoints

- **Application Health:** `GET /health`
- **API Health:** `GET /api/health`
- **Service Status:** `GET /api/packages`

### Container Health Checks

```bash
# Check container health
docker-compose ps

# View health check logs
docker inspect poc-server | grep -A 10 "Health"

# Manual health check
curl http://localhost/api/health
```

## ğŸ† Architecture Benefits

### Monorepo Advantages

- **Shared Dependencies:** Consistent package versions across all services
- **Code Reuse:** Common utilities and types shared between packages
- **Atomic Changes:** Cross-package changes in single commits
- **Simplified CI/CD:** Single repository for all services

### Docker Benefits

- **Environment Consistency:** Identical development and production environments
- **Service Isolation:** Independent scaling and deployment
- **Easy Orchestration:** Simple multi-service management
- **Production Ready:** Security, health checks, and monitoring

### Scalability Features

- **Horizontal Scaling:** Multiple server instances behind load balancer
- **Service Separation:** Independent package deployment
- **Resource Optimization:** Efficient container resource usage
- **Development Efficiency:** Hot reloading and fast builds

## ğŸ“š Additional Resources

- [NPM Workspaces Documentation](https://docs.npmjs.com/cli/v7/using-npm/workspaces)
- [Docker Compose Documentation](https://docs.docker.com/compose/)
- [Vite Build Tool](https://vitejs.dev/)
- [Express.js Framework](https://expressjs.com/)

## ğŸ¤ Contributing

1. Fork the repository
2. Create a feature branch (`git checkout -b feature/amazing-feature`)
3. Commit your changes (`git commit -m 'Add amazing feature'`)
4. Push to the branch (`git push origin feature/amazing-feature`)
5. Open a Pull Request

## ğŸ“„ License

This project is licensed under the MIT License - see the [LICENSE](LICENSE) file for details.